"use strict";var _createClass=function(){function n(n,e){for(var t in e){var s=e[t];s.configurable=!0,s.value&&(s.writable=!0)}Object.defineProperties(n,e)}return function(e,t,s){return t&&n(e.prototype,t),s&&n(e,s),e}}(),_classCallCheck=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},MessageBus;!function(n){function e(n){return new t(n)}var t=function(){function n(e){var t=this;_classCallCheck(this,n),this._channels={},this._unlisten=null,this._endpoint=e;var s=function(n){return t._onEvent(n.data.name,n.data.payload)},a=function(n){return t._onEvent("error",n)};e.addEventListener("message",s),e.addEventListener("error",a),this._unlisten=function(){e.removeEventListener("message",s),e.removeEventListener("error",a)}}return _createClass(n,{close:{value:function(){null!==this._unlisten&&this._unlisten(),this._unlisten=null,this._channels={}}},on:{value:function(n,e){var t=n.toString();this._channelExists(t)||(this._channels[t]=[]),this._channels[t].push(e)}},off:{value:function(n,e){var t=n.toString();if(this._channelExists(t)){var s=this._channels[t],a=s.indexOf(e);a!==-1&&s.splice(a,1)}}},emit:{value:function(n,e){var t=n.toString();this._endpoint.postMessage({name:t,payload:e})}},_channelExists:{value:function(n){return this._channels.hasOwnProperty(n)}},_onEvent:{value:function(n,e){if(this._channelExists(n)){var t=!0,s=!1,a=void 0;try{for(var i,r=this._channels[n][Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;o(e)}}catch(l){s=!0,a=l}finally{try{!t&&r["return"]&&r["return"]()}finally{if(s)throw a}}}}}}),n}();n.MessageBus=t,n.create=e}(MessageBus||(MessageBus={}));
//# sourceMappingURL=MessageBus.js.map
